<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Elite Unlock ‚Äî ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πâ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏∏‡πâ‡∏° ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß)</title>
  <meta name="description" content="‡∏Ç‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πâ Unlocktool, TSM TOOL PRO ‡∏Ø‡∏•‡∏Ø ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡∏°‡∏µ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .card-hover{transition:.25s ease}
    .card-hover:hover{transform:translateY(-5px);box-shadow:0 15px 30px rgba(0,0,0,.08)}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:50}
    .modal.active{display:flex}
    .badge{display:inline-flex;align-items:center;gap:.5rem;padding:.4rem .7rem;border-radius:.6rem;font-size:.8rem}
  </style>
</head>
<body class="bg-gradient-to-b from-slate-50 to-slate-100 text-slate-800 antialiased">
  <!-- Header -->
  <header class="max-w-6xl mx-auto px-6 py-6 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-indigo-600 to-pink-500 text-white font-bold flex items-center justify-center">EU</div>
      <div>
        <h1 class="text-2xl font-semibold">Elite Unlock ‚Äî ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</h1>
        <p class="text-sm text-slate-600">
          ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πâ 100% ‚Ä¢ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‚Ä¢ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏Å‡∏ß‡πà‡∏≤ ‚Ä¢ ‡∏°‡∏µ‡∏î‡∏π‡πÅ‡∏•‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á
        </p>
      </div>
    </div>
    <button id="contactBtn" class="bg-indigo-600 text-white text-sm px-4 py-2 rounded-md shadow">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ / ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
  </header>

  <main class="max-w-6xl mx-auto px-6 pb-16">
    <!-- Hero badges -->
    <section class="mb-6">
      <div class="rounded-2xl p-6 bg-white shadow">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
          <div>
            <h2 class="text-2xl md:text-3xl font-extrabold">‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à ‚Äî ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πâ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£ ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß</h2>
            <p class="text-slate-600 mt-1">
              ‡∏Ñ‡∏µ‡∏¢‡πå/‡πÑ‡∏•‡πÄ‡∏ã‡∏ô‡∏™‡πå‡πÅ‡∏ó‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Unlocktool, TSM TOOL PRO ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
            </p>
          </div>
          <div class="flex flex-wrap gap-2">
            <span class="badge bg-emerald-50 text-emerald-700">‚úî ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
            <span class="badge bg-sky-50 text-sky-700">‚è± ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß</span>
            <span class="badge bg-amber-50 text-amber-700">‡∏ø ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£</span>
            <span class="badge bg-violet-50 text-violet-700">üõü ‡∏ã‡∏±‡∏û‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Search -->
    <section class="mb-4">
      <div class="relative w-full md:w-96">
        <input id="searchInput" type="search"
               placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° ‡∏´‡∏£‡∏∑‡∏≠ ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à (‡πÄ‡∏ä‡πà‡∏ô Unlocktool, 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, 1 ‡∏õ‡∏µ)"
               class="w-full p-3 pl-10 rounded-lg border bg-white shadow-sm outline-none focus:ring-2 focus:ring-indigo-500">
        <svg class="w-5 h-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.3-4.3M10 18a8 8 0 100-16 8 8 0 000 16z"/>
        </svg>
      </div>
      <p id="status" class="text-sm text-slate-600 mt-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
    </section>

    <!-- Packages (cards grouped) -->
    <section id="pricing" class="mb-10">
      <h3 class="text-2xl font-bold mb-4">‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°</h3>
      <div id="groups" class="grid gap-6 md:grid-cols-2"></div>
      <p id="emptyState" class="hidden text-sm text-slate-500 mt-4">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
    </section>

    <!-- Trust sections -->
    <section class="mb-10 grid md:grid-cols-3 gap-4">
      <div class="p-5 rounded-2xl bg-white shadow">
        <h4 class="font-bold text-lg mb-2">‡∏ó‡∏≥‡πÑ‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏£‡∏≤</h4>
        <ul class="text-sm space-y-2 text-slate-700">
          <li>‚Ä¢ ‡πÑ‡∏•‡πÄ‡∏ã‡∏ô‡∏™‡πå‡πÅ‡∏ó‡πâ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ</li>
          <li>‚Ä¢ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£ ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß</li>
          <li>‚Ä¢ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏¥‡∏ß ‡πÑ‡∏°‡πà‡∏î‡∏≠‡∏á‡∏á‡∏≤‡∏ô</li>
          <li>‚Ä¢ ‡∏°‡∏µ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠/‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏à‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</li>
          <li>‚Ä¢ ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á ‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á</li>
        </ul>
      </div>
      <div class="p-5 rounded-2xl bg-white shadow">
        <h4 class="font-bold text-lg mb-2">‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô & ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢</h4>
        <ul class="text-sm space-y-2 text-slate-700">
          <li>‚Ä¢ ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</li>
          <li>‚Ä¢ ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‚Äî ‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</li>
          <li>‚Ä¢ ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
          <li>‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞/‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÑ‡∏î‡πâ</li>
        </ul>
      </div>
      <div class="p-5 rounded-2xl bg-white shadow">
        <h4 class="font-bold text-lg mb-2">‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h4>
        <div class="text-sm text-slate-700">
          ‚Äú‡∏Ñ‡∏µ‡∏¢‡πå‡πÅ‡∏ó‡πâ ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏≠‡πÄ‡∏Ñ ‡∏ã‡∏±‡∏û‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏î‡∏µ‚Äù ‚Äî <span class="text-slate-500">‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠</span><br/>
          ‚Äú‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏Å‡πá‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‚Äù ‚Äî <span class="text-slate-500">‡∏Ñ‡∏∏‡∏ì‡∏ö‡∏µ</span>
        </div>
      </div>
    </section>

    <!-- Contact (on-page) -->
    <section id="contact" class="rounded-2xl p-6 bg-white shadow">
      <h3 class="text-2xl font-bold mb-2">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ / ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
      <div class="grid md:grid-cols-3 gap-6">
        <div class="space-y-1 text-sm">
          <div class="font-semibold">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</div>
          <div class="text-slate-800 text-base">062-607-2670</div>
          <div class="text-xs text-slate-500">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ 09:00‚Äì21:00 ‡∏ô.</div>
        </div>
        <div class="space-y-1 text-sm">
          <div class="font-semibold">Facebook</div>
          <a class="text-indigo-600 hover:underline break-all" href="https://www.facebook.com/S.Sonsupap" target="_blank" rel="noopener">
            facebook.com/S.Sonsupap
          </a>
        </div>
        <div class="space-y-1 text-sm">
          <div class="font-semibold">LINE</div>
          <div class="text-slate-700">ID: <span class="font-medium">@yourlineid</span></div>
          <div class="flex items-center gap-3">
            <img src="https://via.placeholder.com/120x120.png?text=LINE+QR" alt="LINE QR Code" class="w-24 h-24 rounded-md border" />
            <a class="text-indigo-600 hover:underline" href="https://line.me/R/ti/p/@yourlineid" target="_blank" rel="noopener">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</a>
          </div>
        </div>
      </div>
      <div class="mt-4 text-xs text-slate-500">*‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ</div>
    </section>
  </main>

  <!-- Modal Contact -->
  <div id="contactModal" class="modal" aria-hidden="true">
    <div class="bg-white rounded-xl shadow-lg max-w-lg w-full p-6 relative">
      <button id="closeModal" class="absolute right-3 top-3 text-slate-400 hover:text-slate-600 text-lg" aria-label="Close">&times;</button>
      <h3 class="text-xl font-bold mb-4 text-center">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ / ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
      <div class="space-y-4 text-sm">
        <div>
          <div class="font-semibold text-slate-700">üìû ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</div>
          <div class="text-lg text-indigo-700">062-607-2670</div>
        </div>
        <div>
          <div class="font-semibold text-slate-700">üìò Facebook</div>
          <a href="https://www.facebook.com/S.Sonsupap" target="_blank" class="text-indigo-600 hover:underline">
            facebook.com/S.Sonsupap
          </a>
        </div>
        <div>
          <div class="font-semibold text-slate-700">üí¨ LINE</div>
          <p>ID: <strong>@yourlineid</strong></p>
          <div class="flex gap-4 items-center mt-2">
            <img src="https://via.placeholder.com/120x120.png?text=LINE+QR" alt="LINE QR" class="w-24 h-24 rounded-md border">
            <a href="https://line.me/R/ti/p/@yourlineid" target="_blank" class="text-indigo-600 hover:underline">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="max-w-6xl mx-auto px-6 py-6 text-sm text-slate-500 text-center">
    ¬© 2025 Elite Unlock ¬∑ ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πâ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£ ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß ¬∑ ‡πÇ‡∏ó‡∏£ 062-607-2670 ¬∑ FB: S.Sonsupap ¬∑ LINE: @yourlineid
  </footer>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // ----- Elements (‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) -----
    const CSV_URL   = "https://raw.githubusercontent.com/sathapon-son/web_EliteUnlock/main/data.csv";
    const groupsEl  = document.getElementById("groups");
    const statusEl  = document.getElementById("status");
    const emptyEl   = document.getElementById("emptyState");
    const searchEl  = document.getElementById("searchInput");
    const contactBtn= document.getElementById("contactBtn");
    const modal     = document.getElementById("contactModal");
    const closeBtn  = document.getElementById("closeModal");

    // ----- Helpers -----
    const HEADERS = {
      program:["‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°","program","tool","‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°"],
      pack:["‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à","package","term","‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤","duration","plan"],
      price:["‡∏£‡∏≤‡∏Ñ‡∏≤","price","cost","‡∏ö‡∏≤‡∏ó"]
    };
    const norm = s => (s??"").toString().trim();
    const nk   = s => norm(s).toLowerCase().replace(/\s+/g,"").replace(/[._-]/g,"");

    function parseCSV(text){
      const rows=[]; let r=[], c="", q=false;
      for(let i=0;i<text.length;i++){
        const ch=text[i], n=text[i+1];
        if(q){
          if(ch=='"'&&n=='"'){ c+='"'; i++; }
          else if(ch=='"'){ q=false; }
          else c+=ch;
        }else{
          if(ch=='"') q=true;
          else if(ch==','){ r.push(c); c=""; }
          else if(ch=='\n'){ r.push(c); rows.push(r); r=[]; c=""; }
          else if(ch=='\r'){ }
          else c+=ch;
        }
      }
      if(c.length>0 || r.length>0){ r.push(c); rows.push(r); }
      return rows;
    }

    function mapHeaders(cols){
      const map={};
      cols.forEach((c,i)=>{
        const key=nk(c);
        for(const std in HEADERS){
          if(HEADERS[std].some(h=>nk(h)===key)) map[std]=i;
        }
      });
      if(map.program==null||map.pack==null||map.price==null){
        throw new Error("‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ: ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°, ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à, ‡∏£‡∏≤‡∏Ñ‡∏≤");
      }
      return map;
    }

    const currencyTH = v => {
      const n=Number(String(v).replace(/[^\d.]/g,""));
      return isNaN(n)?norm(v):n.toLocaleString("th-TH");
    };

    function groupByProgram(items){
      const g={};
      for(const it of items){
        const k=norm(it.program)||"‡∏≠‡∏∑‡πà‡∏ô ‡πÜ";
        if(!g[k]) g[k]=[];
        g[k].push(it);
      }
      return g;
    }

    function render(groups, filter=""){
      const q=nk(filter);
      groupsEl.innerHTML="";
      let total=0;

      Object.entries(groups).forEach(([program,plans])=>{
        const keep=plans.filter(p=>!q || nk(program).includes(q) || nk(p.pack).includes(q));
        if(!keep.length) return;
        total+=keep.length;

        const card=document.createElement("div");
        card.className="card-hover bg-white rounded-2xl p-6 shadow";
        card.innerHTML=`
          <div class="flex items-center justify-between mb-4">
            <div>
              <h4 class="text-xl font-semibold">${program}</h4>
              <p class="text-sm text-slate-500">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
            </div>
            <span class="text-xs px-2 py-1 bg-slate-100 rounded">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏∏‡πâ‡∏°</span>
          </div>
          <div class="grid grid-cols-1 sm:grid-cols-3 gap-3" data-body></div>`;
        const body=card.querySelector("[data-body]");

        keep.forEach(p=>{
          const item=document.createElement("div");
          item.className="border rounded-lg p-4 text-center";
          item.innerHTML=`
            <div class="text-sm text-slate-500">${p.pack}</div>
            <div class="text-2xl font-extrabold mt-2">‡∏ø${currencyTH(p.price)}</div>
          `;
          body.appendChild(item);
        });

        groupsEl.appendChild(card);
      });

      emptyEl.classList.toggle("hidden", total>0);
    }

    function rowsToItems(rows){
      if(!rows.length) throw new Error("CSV ‡∏ß‡πà‡∏≤‡∏á");
      const headers=rows[0];
      const map=mapHeaders(headers);
      return rows.slice(1)
        .filter(r=>r.length && r.some(c=>norm(c)!==""))
        .map(r=>({ program:r[map.program]??"", pack:r[map.pack]??"", price:r[map.price]??"" }))
        .filter(x=>norm(x.program)&&norm(x.pack)&&norm(x.price));
    }

    async function loadData(){
      if(statusEl) statusEl.textContent="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
      try{
        const res=await fetch(CSV_URL,{cache:"no-store"});
        if(!res.ok) throw new Error(`HTTP ${res.status}`);
        const text=await res.text();
        const rows=parseCSV(text);
        const items=rowsToItems(rows);
        window.__DATA = groupByProgram(items);
        render(window.__DATA, searchEl?.value||"");
        if(statusEl) statusEl.textContent="‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: "+new Date().toLocaleString("th-TH");
      }catch(e){
        if(statusEl) statusEl.innerHTML=`<span class="text-red-600">‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:</span> ${e.message}`;
        console.error(e);
      }
    }

    // ----- Bind events -----
    if(searchEl){
      searchEl.addEventListener("input", ()=>render(window.__DATA||{}, searchEl.value));
    }
    if(contactBtn && modal && closeBtn){
      contactBtn.addEventListener("click", ()=> modal.classList.add("active"));
      closeBtn.addEventListener("click", ()=> modal.classList.remove("active"));
      modal.addEventListener("click", (e)=>{ if(e.target===modal) modal.classList.remove("active"); });
    }

    // ----- Init -----
    loadData();
    setInterval(loadData, 5*60*1000);
  });
  </script>
</body>
</html>
